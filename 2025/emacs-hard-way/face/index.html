<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-CN" 
      xml:lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" 
        content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>淡妆</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../../appearance/lmd.css" />
</head>
<body>

<header id="title-block-header">
  <h1 class="title">淡妆
    <span class="back-to-top-span">    <a href="../index.html">
      <button id="back-to-top" aria-label="返回目录">▲</button>
    </a></span></h1>
</header>
<p class="date">2025 年 05 月 28 日</p>

<nav id="TOC" role="doc-toc">
  <ul>
  <li><a href="#前言" id="toc-前言">前言</a></li>
  <li><a href="#行距" id="toc-行距">行距</a></li>
  <li><a href="#缩进" id="toc-缩进">缩进</a></li>
  <li><a href="#颜值" id="toc-颜值">颜值</a></li>
  <li><a href="#函数" id="toc-函数">函数</a></li>
  <li><a href="#新颜" id="toc-新颜">新颜</a></li>
  <li><a href="#总结" id="toc-总结">总结</a></li>
  </ul>
</nav>

<h1 id="前言">前言</h1>
<p>此刻，我在 Linux mint 桌面环境使用 Emacs
的图形界面模式。我感觉它有些丑陋。美观固然不必追求，但丑陋也不必容忍。其丑陋之处在于，文字行距过于紧密，且两侧边界的颜色过浅，背景色较深，不伦不类。</p>
<figure>
<img src="figures/01.png" alt="Emacs 外观" />
<figcaption aria-hidden="true">Emacs 外观</figcaption>
</figure>
<h1 id="行距">行距</h1>
<p>Emacs 缓冲区里的文字行距是由变量 <code>line-spacing</code>
控制，其值默认为 <code>nil</code>。</p>
<p>在 Elisp 中，可使用 <code>setq</code> 为变量赋值，例如</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">setq</span> a <span class="dv">1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>      b <span class="dv">2</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>      c <span class="dv">3</span>)</span></code></pre></div>
<p>上述代码为变量 <code>a</code>，<code>b</code> 和 <code>c</code>
分别赋以 1，2 和 3，亦即 <code>setq</code> 表达式可为一组变量赋值。</p>
<p>用 <code>setq</code> 可将 <code>line-spacing</code> 值设为 4
个像素，如下</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">setq</span> line-spacing <span class="dv">4</span>)</span></code></pre></div>
<p>不过，<code>line-spacing</code> 是缓冲区局部变量（Buffer-local
variable），若对上述表达式求值，只有当前缓冲区的文字行距会发生变化，其他缓冲区则不受影响。</p>
<p>倘若你不想每次开启缓冲区，都要设定一次 <code>line-spacing</code>
的值，对于此类缓冲区局部变量的赋值，一劳永逸的方法是使用
<code>setq-default</code>
直接为此类变量设定默认值。<code>setq-default</code> 的用法与
<code>setq</code> 相同。</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(setq-default line-spacing <span class="dv">4</span>)</span></code></pre></div>
<h1 id="缩进">缩进</h1>
<p>若主要是用 Emacs
编写代码，可能会遇到制表符不一致而导致的代码缩进混乱，原因是制表符的宽度并不固定，有的软件将其设为
4 个空格宽度，有的则设为 8 个空格宽度。故而，你在 Emacs
里编写的代码，在其他软件里打开，可能会出现缩进混乱的情况。为了避免这种情况，建议禁用制表符，让
Emacs 自动以空格作为代替，亦即在 init.el 中添加以下设定：</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(setq-default indent-tabs-mode <span class="kw">nil</span>) <span class="co">;; 用空格代替 Tab</span></span></code></pre></div>
<p>由于 <code>indent-tabs-mode</code> 是缓冲区局部变量，倘若用 Emacs
编辑诸如 Makefile
之类必须使用制表符的文件，对应的编辑模式会主动将这个变量设为
<code>t</code>，从而启用制表符。</p>
<p><strong>练习</strong>：执行
<code>C-h v tab-width RET</code>，查看缓冲区局部变量
<code>tab-width</code> 的说明。</p>
<h1 id="颜值">颜值</h1>
<p>Emacs 的 <code>set-face-attribute</code>
函数能够修改缓冲区背景、边框以及模式行的颜色，所谓模式行即缓冲区与微缓冲区之间的工具条，用于显示缓冲区的名字、文字行号、编辑模式等信息。若在图形界面模式下，模式行提供了可与鼠标交互的菜单功能。</p>
<p>Emacs 默认的缓冲区背景色较深，可以使用以下代码将其修改为银色：</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(set-face-attribute <span class="dt">&#39;default</span> <span class="kw">nil</span> :background <span class="st">&quot;#f0f0f0&quot;</span>)</span></code></pre></div>
<p><code>set-face-attribute</code>
的第一个参数表示要修改的颜面（Face）类型，若该参数为
<code>'default</code>，表示默认的颜面，或者最大的颜面，不妨将其理解为主颜面，即框架的外观。第二个参数是颜面所在的框架，若其值为
<code>nil</code> 则表示当前框架。其余参数皆为键值对，例如
<code>:background</code> 是键，表示颜面的背景，<code>#f0f0f0</code>
是值，是银白色。</p>
<p>接下来，继续用 <code>set-face-attribute</code>
设置框架两侧边框的颜色：</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(set-face-attribute <span class="dt">&#39;fringe</span> <span class="kw">nil</span> :background <span class="st">&quot;#f0f0f0&quot;</span>)</span></code></pre></div>
<p>框架两侧的边框叫作 <code>'fringe</code>，其背景色与
<code>'default</code> 颜面相同，亦即边框颜色与框架背景色相同。</p>
<p>以下代码设置模式行的背景，并将其边框线宽设为 2
个像素，边框颜色设为蓝灰色。</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(set-face-attribute <span class="dt">&#39;mode-line</span> <span class="kw">nil</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>                    :background <span class="st">&quot;#e0e0e0&quot;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>                    :box `(:line-width <span class="dv">2</span> :color <span class="st">&quot;#a1afc9&quot;</span>))</span></code></pre></div>
<p>当 Emacs
存在多个窗口时，每个都会有一个模式行，但是只有输入焦点所在的窗口，其模式行是激活状态，其他窗口的模式行皆为非激活态。Emacs
也允许定制非激活态的模式行外观，如下：</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(set-face-attribute <span class="dt">&#39;mode-line-inactive</span> <span class="kw">nil</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                    :background <span class="st">&quot;#f0f0f0&quot;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                    :box `(:line-width <span class="dv">1</span> :color <span class="st">&quot;#a1afc9&quot;</span>))</span></code></pre></div>
<p>这一切应该不难理解，动手一试，便知其意。</p>
<p><code>set-face-attribute</code> 能修改 Emacs
中的一切颜面，前提是你需要知道它们的名字。<code>M-x list-faces-display</code>
可以查看全部颜面的名字。</p>
<h1 id="函数">函数</h1>
<p>上文对框架外观的设定，有几处使用了相同的颜色值
<code>#f0f0f0</code>，即框架的背景、框架两侧边框的背景以及非激活态模式行的背景，所用颜色相同，激活态模式行的背景色是
<code>#e0e0e0</code>，较 <code>#f0f0f0</code>
略深一些。模式行的边框颜色相同，只是线宽有差异。我们可以将整个外观设定过程定义为一个函数，将颜色值作为函数的参数传入，不仅是的外观定制过程更为集中，也便于以后修改外观颜色。</p>
<p>Elisp 函数定义形式如下</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">defun</span><span class="fu"> </span>函数名 (参数表)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    函数体)</span></code></pre></div>
<p>将上文对 Emacs 外观的所有设定封装为函数 <code>my-theme</code>：</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">defun</span><span class="fu"> my-theme </span>(bg-color mode-line-bg-color)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    (setq-default line-spacing <span class="dv">4</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    (set-face-attribute <span class="dt">&#39;default</span> <span class="kw">nil</span> :background bg-color)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    (set-face-attribute <span class="dt">&#39;fringe</span> <span class="kw">nil</span> :background bg-color)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    (set-face-attribute <span class="dt">&#39;mode-line</span> <span class="kw">nil</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>                        :background mode-line-bg-color</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>                        :box &#39;(:line-width <span class="dv">2</span> :color <span class="st">&quot;#a1afc9&quot;</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    (set-face-attribute <span class="dt">&#39;mode-line-inactive</span> <span class="kw">nil</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                        :background bg-color</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                        :box &#39;(:line-width <span class="dv">1</span> :color <span class="st">&quot;#a1afc9&quot;</span>)))</span></code></pre></div>
<p>需要注意的是，函数的定义也是一个表达式，Emacs
对其求值结果是函数名，你不妨在函数定义后面 <code>C-x C-e</code>
一试。<code>my-theme</code> 的用法如下：</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(my-theme <span class="st">&quot;#f0f0f0&quot;</span> <span class="st">&quot;#e0e0e0&quot;</span>)</span></code></pre></div>
<p>Emacs 对上述代码求值，便可完成外观设定。</p>
<h1 id="新颜">新颜</h1>
<p>上文所作的一切设定，只对 Emacs
的图形界面模式有效，故而相关代码应当放在 init.el 文件里的
<code>when</code> 表达式中。希望你没有忘记，我们已在 <code>when</code>
表达式里设定了字体。现在若加入文字行距与框架组件背景色的设定，代码应当如下：</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode lisp"><code class="sourceCode commonlisp"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">when</span> window-system</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;配置中英文字体</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    (set-frame-font (font-spec <span class="bu">:name</span> <span class="st">&quot;Monaco&quot;</span> :size <span class="dv">12</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    (<span class="kw">dolist</span> (script &#39;(han cjk-misc bopomofo))</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>        (set-fontset-font </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>            (frame-parameter <span class="kw">nil</span> <span class="dt">&#39;font</span>) </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>            script</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>            (font-spec <span class="bu">:name</span> <span class="st">&quot;Microsoft YaHei&quot;</span> :size <span class="dv">12</span>)))</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">;;配置 Emacs 框架外观</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    (my-theme <span class="st">&quot;#f0f0f0&quot;</span> <span class="st">&quot;#e0e0e0&quot;</span>))</span></code></pre></div>
<p>上述代码中的分号，是 Elisp
语言的注释符。每行注释，只需以一个分号作为开头即可。我习惯写两个分号，是为了让注释更醒目一些。现在，我的
Emacs 外观变成了如下图所示的样子，我已对它已基本满意。</p>
<figure>
<img src="figures/02.png" alt="换了新颜" />
<figcaption aria-hidden="true">换了新颜</figcaption>
</figure>
<h1 id="总结">总结</h1>
<p>许多人的 Emacs 外观配置得远比我的精美，这意味着他们的
<code>(when window-system ...)</code>
表达式中增加的代码会多一些，故而他们的 init.el
的可维护性会差一些，于是他们的 Emacs
启动速度会慢一些，应变的能力也会弱一些。</p>
<p>也许任何事物，其外观和性能本质上是混而为一的，即所谓的，色不异空，空不异色；色即是空，空即是色；受想行识，亦复如是。倘若你需要将
Emacs 作为礼器，可执着于色相。倘若你需要将 Emacs
作为工具甚至武器，需守着它的空性。</p>

<div class="footer">需要联系我吗？请发邮件至 <a
href="mailto:lyr.m2@live.cn" class="email">lyr.m2@live.cn</a></div>
</body>
</html>
